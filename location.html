<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find Nearest Organization</title>
</head>
<body>
    <h1>Find Nearest Organization</h1>
    
    <form id="locationForm">
        <label for="userLocation">Your Location:</label>
        <input type="text" id="userLocation" placeholder="Enter your location" required>
        <button type="submit">Find Nearest Organization</button>
    </form>

    <div id="results">
        <h2>Search Results:</h2>
        <ul id="organizationList">
        </ul>
    </div>

    <script>
        const organizations = [
    { name: "Clean Sweep Services", lat: 40.7128, lon: -74.0060 },
    { name: "Green Cleaners", lat: 34.0522, lon: -118.2437 },
    { name: "Fresh Start Cleaning", lat: 51.5074, lon: -0.1278 },
    { name: "Sparkling Clean Co.", lat: 35.6895, lon: 139.6917 },
    { name: "Dusty Busters", lat: 52.5200, lon: 13.4050 },
    { name: "Shiny Surfaces", lat: -33.8688, lon: 151.2093 },
    { name: "Crystal Cleaners", lat: 41.8781, lon: -87.6298 },
    { name: "Pure Shine Services", lat: 48.8566, lon: 2.3522 },
    { name: "Gleaming Homes Inc.", lat: 37.7749, lon: -122.4194 },
    { name: "Sunny Side Cleaners", lat: -22.9083, lon: -43.1964 },
];


        const locationForm = document.getElementById("locationForm");
        const organizationList = document.getElementById("organizationList");

        locationForm.addEventListener("submit", function (e) {
            e.preventDefault();
            
            const userLocation = document.getElementById("userLocation").value;

            // Use OpenCage Geocoding API to obtain user location coordinates (replace with your own API key)
            fetch(`https://api.opencagedata.com/geocode/v1/json?q=${userLocation}&key=7737b14473254ebeba287ce154792689`)
                .then(response => response.json())
                .then(data => {
                    const userLat = data.results[0].geometry.lat;
                    const userLon = data.results[0].geometry.lng;

                    // Calculate distances to organizations and find the nearest one
                    const nearestOrganization = findNearestOrganization(organizations, userLat, userLon);

                    if (nearestOrganization) {
                        // Display the nearest organization in the results
                        organizationList.innerHTML = `<li>${nearestOrganization.name}</li>`;
                    } else {
                        organizationList.innerHTML = "<li>No organizations found.</li>";
                    }
                })
                .catch(error => {
                    console.error("Error:", error);
                });
        });

        function findNearestOrganization(orgList, userLat, userLon) {
            let nearestOrg = null;
            let nearestDistance = Infinity;

            orgList.forEach(org => {
                const distance = calculateDistance(userLat, userLon, org.lat, org.lon);
                if (distance < nearestDistance) {
                    nearestOrg = org;
                    nearestDistance = distance;
                }
            });

            return nearestOrg;
        }

        // Simplified Haversine formula for calculating distances
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371;
            const dLat = (lat2 - lat1) * (Math.PI / 180);
            const dLon = (lon2 - lon1) * (Math.PI / 180);

            const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                Math.cos(lat1 * (Math.PI / 180)) * Math.cos(lat2 * (Math.PI / 180)) *
                Math.sin(dLon / 2) * Math.sin(dLon / 2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));

            return R * c;
        }
    </script>
</body>
</html>
